<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>COE301 LAB NOTES</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="solarized-dark.min.css" />
<link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body>
<div id="content" class="content">
<h1 class="title">COE301 LAB NOTES</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org5740522">Resources</a></li>
<li><a href="#org0aa1bf2">MIPS assembly</a>
<ul>
<li><a href="#orge74abf9">Introduction</a>
<ul>
<li><a href="#org0b3c449">Mars simulator Setup</a></li>
<li><a href="#org568058a">Hello, World</a></li>
<li><a href="#orgf76c7ce">More about MIPS assembly</a></li>
<li><a href="#orga1083e1">Basic Syscalls</a></li>
<li><a href="#orgb252ca5">Registers</a></li>
</ul>
</li>
<li><a href="#org8229163">Useful Macros</a></li>
</ul>
</li>
</ul>
</div>
</div>
<blockquote>
<ul class="org-ul">
<li>I recommend viewing this website on a non mobile device</li>
<li>Github repositary of this document <a href="https://github.com/Airbus5717/coe301">repo</a> which contains Term221 resources too</li>
<li>If you find any issue, report it here <a href="https://github.com/Airbus5717/coe301/issues">report issue</a></li>
</ul>
</blockquote>

<div id="outline-container-org5740522" class="outline-2">
<h2 id="org5740522">Resources</h2>
<div class="outline-text-2" id="text-org5740522">
<ul class="org-ul">
<li>Dr. Mudawar resources <a href="https://faculty.kfupm.edu.sa/coe/mudawar/coe301/lectures/index.htm">slides, examples etc.</a></li>
<li>MIPS syscalls <a href="https://courses.missouristate.edu/kenvollmar/mars/help/syscallhelp.html%20">link</a></li>
<li>Mars mips simulator <a href="https://courses.missouristate.edu/KenVollmar/mars/download.htm">link</a></li>
<li>Dr. Mudawwar&rsquo;s videos <a href="https://youtube.com/playlist?list=PLeurb_BIjrxjSmBhm_h3TkN8pWxM_1ViU">link</a></li>
<li>MIPS assembly reference <a href="https://uweb.engr.arizona.edu/~ece369/Resources/spim/MIPSReference.pdf">arizona uni</a></li>
<li>Mips assembly videos <a href="https://www.youtube.com/playlist?list=PL1C2GgOjAF-KYdV5bH-xzoybEHreDZ3Kh">Padraic Edgington</a></li>
<li>Mips assembly videos <a href="https://www.youtube.com/playlist?list=PL5b07qlmA3P6zUdDf-o97ddfpvPFuNa5A">Amell Peralta</a></li>
<li>Mips assembly Slides from oregon state uni <a href="https://web.engr.oregonstate.edu/~walkiner/cs271-wi13/slides/">class 2013</a></li>
</ul>
<hr />
</div>
</div>

<div id="outline-container-org0aa1bf2" class="outline-2">
<h2 id="org0aa1bf2">MIPS assembly</h2>
<div class="outline-text-2" id="text-org0aa1bf2">
</div>
<div id="outline-container-orge74abf9" class="outline-3">
<h3 id="orge74abf9">Introduction</h3>
<div class="outline-text-3" id="text-orge74abf9">
</div>
<div id="outline-container-org0b3c449" class="outline-4">
<h4 id="org0b3c449">Mars simulator Setup</h4>
<div class="outline-text-4" id="text-org0b3c449">
<ol class="org-ol">
<li>File (or Ctrl-N) -&gt; New File</li>
<li>Copy paste the code below</li>
<li>Save the file (or Ctrl-S)</li>
<li>Run (or F3) -&gt; Assemble</li>
<li>If assembling was successful then continue</li>
<li>Go (or F5) to run the whole program at once</li>
</ol>
</div>
</div>


<div id="outline-container-org568058a" class="outline-4">
<h4 id="org568058a">Hello, World</h4>
<div class="outline-text-4" id="text-org568058a">
<div class="org-src-container">
<pre class="src src-mips"><span style="color: #928374;"># </span><span style="color: #b8bb26; font-weight: bold;">NOTE:</span><span style="color: #928374;"> Hello, World in assembly</span>
<span style="color: #ebdbb2; font-weight: bold;">.globl</span> main

<span style="color: #928374;"># </span><span style="color: #928374;">data segment (global variables)</span>
<span style="color: #ebdbb2; font-weight: bold;">.data</span>
<span style="color: #b8bb26;">msg:</span> <span style="color: #ebdbb2; font-weight: bold;">.asciiz</span> <span style="color: #b8bb26;">"Hello, World\n"</span>
    <span style="color: #928374;"># </span><span style="color: #928374;">asciiz includes the null terminator (\0) in string</span>

<span style="color: #928374;"># </span><span style="color: #928374;">code segment</span>
<span style="color: #ebdbb2; font-weight: bold;">.text</span>
<span style="color: #b8bb26;">main:</span>
    <span style="color: #928374;"># </span><span style="color: #928374;">print string msg</span>
    <span style="color: #928374;"># </span><span style="color: #928374;">4 is the syscall number for print string</span>
    <span style="color: #83a598;">la</span> <span style="color: #fabd2f;">$a0</span><span style="color: #fe8019;">,</span> msg <span style="color: #928374;"># </span><span style="color: #928374;">loads address of msg to $a0</span>
    <span style="color: #83a598;">li</span> <span style="color: #fabd2f;">$v0</span><span style="color: #fe8019;">,</span> <span style="color: #d3869b; font-weight: bold;">4</span>   <span style="color: #928374;"># </span><span style="color: #928374;">loads immediate (4) to $v0</span>
    <span style="color: #fb4934;">syscall</span>

    <span style="color: #928374;"># </span><span style="color: #928374;">exit</span>
    <span style="color: #928374;"># </span><span style="color: #928374;">exit syscall is 10</span>
    <span style="color: #83a598;">li</span> <span style="color: #fabd2f;">$v0</span><span style="color: #fe8019;">,</span> <span style="color: #d3869b; font-weight: bold;">10</span> 
    <span style="color: #fb4934;">syscall</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf76c7ce" class="outline-4">
<h4 id="orgf76c7ce">More about MIPS assembly</h4>
<div class="outline-text-4" id="text-orgf76c7ce">
<p>
MIPS assembly was introduced in 1986 and there are different versions (I, I, &#x2026;, MIPS32, MIPS64).
</p>
</div>
</div>

<div id="outline-container-orga1083e1" class="outline-4">
<h4 id="orga1083e1">Basic Syscalls</h4>
<div class="outline-text-4" id="text-orga1083e1">
<p>
Full reference MIPS syscalls <a href="https://courses.missouristate.edu/kenvollmar/mars/help/syscallhelp.html%20">link</a>
</p>
</div>
</div>

<div id="outline-container-orgb252ca5" class="outline-4">
<h4 id="orgb252ca5">Registers</h4>
<div class="outline-text-4" id="text-orgb252ca5">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Register</td>
<td class="org-left">Number</td>
<td class="org-left">Usage</td>
<td class="org-left">Avoid</td>
</tr>

<tr>
<td class="org-left">$zero</td>
<td class="org-left">$0</td>
<td class="org-left">Always zero</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">$at</td>
<td class="org-left">$1</td>
<td class="org-left">Assembler temporary register</td>
<td class="org-left">true</td>
</tr>

<tr>
<td class="org-left">$v0-$v1</td>
<td class="org-left">$2-$3</td>
<td class="org-left">functions results</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">$a0-$a3</td>
<td class="org-left">$4-$7</td>
<td class="org-left">function arguments</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">$t0-$t7</td>
<td class="org-left">$8-$15</td>
<td class="org-left">for storing temp. values</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">$s0-$s7</td>
<td class="org-left">$16-$23</td>
<td class="org-left">storing across function calls</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">$t8-$t9</td>
<td class="org-left">$24-$25</td>
<td class="org-left">for storing more temp. values</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">$k0-$k1</td>
<td class="org-left">$26-$27</td>
<td class="org-left">for kernel os use</td>
<td class="org-left">true</td>
</tr>

<tr>
<td class="org-left">$gp</td>
<td class="org-left">$28</td>
<td class="org-left">global (data) pointer register</td>
<td class="org-left">true</td>
</tr>

<tr>
<td class="org-left">$sp</td>
<td class="org-left">$29</td>
<td class="org-left">stack pointer (points to the top)</td>
<td class="org-left">true</td>
</tr>

<tr>
<td class="org-left">$fp</td>
<td class="org-left">$30</td>
<td class="org-left">frame pointer (points to stack frame)</td>
<td class="org-left">true</td>
</tr>

<tr>
<td class="org-left">$ra</td>
<td class="org-left">$31</td>
<td class="org-left">return address (return from fn call)</td>
<td class="org-left">true</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org8229163" class="outline-3">
<h3 id="org8229163">Useful Macros</h3>
<div class="outline-text-3" id="text-org8229163">
<p>
use these to develop code faster
</p>
<div class="org-src-container">
<pre class="src src-mips"><span style="color: #928374;"># </span><span style="color: #b8bb26; font-weight: bold;">NOTE:</span><span style="color: #928374;"> useful macros for general development  </span>


<span style="color: #928374;"># </span><span style="color: #928374;">exit program</span>
<span style="color: #928374;"># </span><span style="color: #928374;">no params required</span>
.macro exit() 
    <span style="color: #83a598;">li</span> <span style="color: #fabd2f;">$v0</span><span style="color: #fe8019;">,</span> <span style="color: #d3869b; font-weight: bold;">10</span>
    <span style="color: #fb4934;">syscall</span>
.end_macro

<span style="color: #928374;"># </span><span style="color: #928374;">print strings</span>
<span style="color: #928374;"># </span><span style="color: #928374;">param(s): string address</span>
.macro print_str(%s)
    <span style="color: #83a598;">la</span> <span style="color: #fabd2f;">$a0</span><span style="color: #fe8019;">,</span> %s
    <span style="color: #83a598;">li</span> <span style="color: #fabd2f;">$v0</span><span style="color: #fe8019;">,</span> <span style="color: #d3869b; font-weight: bold;">4</span>
    <span style="color: #fb4934;">syscall</span>
.end_macro

<span style="color: #928374;"># </span><span style="color: #928374;">print string literals</span>
<span style="color: #928374;"># </span><span style="color: #928374;">param(s): string literal</span>
.macro print_strlit(%s)
<span style="color: #ebdbb2; font-weight: bold;">.data</span>
<span style="color: #b8bb26;">string_pointer:</span> <span style="color: #ebdbb2; font-weight: bold;">.asciiz</span> %s
<span style="color: #ebdbb2; font-weight: bold;">.text</span>
    <span style="color: #83a598;">la</span> <span style="color: #fabd2f;">$a0</span><span style="color: #fe8019;">,</span> string_pointer
    <span style="color: #83a598;">li</span> <span style="color: #fabd2f;">$v0</span><span style="color: #fe8019;">,</span> <span style="color: #d3869b; font-weight: bold;">4</span>
    <span style="color: #fb4934;">syscall</span>
.end_macro

<span style="color: #928374;"># </span><span style="color: #928374;">print int</span>
<span style="color: #928374;"># </span><span style="color: #928374;">param(d): int register</span>
.macro print_int(%d)
    <span style="color: #83a598;">la</span> <span style="color: #fabd2f;">$a0</span><span style="color: #fe8019;">,</span> %d
    <span style="color: #83a598;">li</span> <span style="color: #fabd2f;">$v0</span><span style="color: #fe8019;">,</span> <span style="color: #d3869b; font-weight: bold;">1</span>
    <span style="color: #fb4934;">syscall</span>
.end_macro

<span style="color: #928374;"># </span><span style="color: #fabd2f; font-weight: bold;">TODO:</span>
<span style="color: #928374;"># </span><span style="color: #928374;">- for loop (maybe?)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</body>
</html>